<div id="error_explanation">
  <%= flash[:added_to_cart] %>
</div>


<div class="container">
  <div class="card">
    <div class="container-fluid">
      <div class="wrapper row">
        <div class="preview col-md-6">

          <div class="preview-pic tab-content">
            <div class="tab-pane active" id="pic-1"><%= image_tag (@product_variant.product_images.attached? ? @product_variant.product_images.first : "image-not-found.png") %></div>
            <div class="tab-pane" id="pic-2"><%= image_tag ("image-not-found.png") %></div>
            <div class="tab-pane" id="pic-3"><%= image_tag ("image-not-found.png") %></div>
          </div>
          <ul class="preview-thumbnail nav nav-tabs">
            <li class="active"><a data-target="#pic-1" data-toggle="tab"><%= image_tag ("image-not-found.png") %></a></li>
            <li><a data-target="#pic-2" data-toggle="tab"><%= image_tag ("image-not-found.png") %></a></li>
            <li><a data-target="#pic-3" data-toggle="tab"><%= image_tag ("image-not-found.png") %></a></li>
          </ul>
        </div>


        <div class="details col-md-6">
          <h3 class="product-title"><%= @product_variant.product.title %></h3>
          <!--          <div class="rating">-->
          <!--            <div class="stars">-->
          <!--              <span class="fa fa-star checked"></span>-->
          <!--              <span class="fa fa-star checked"></span>-->
          <!--              <span class="fa fa-star checked"></span>-->
          <!--              <span class="fa fa-star"></span>-->
          <!--              <span class="fa fa-star"></span>-->
          <!--            </div>-->
          <!--            <span class="review-no">41 reviews</span>-->
          <!--          </div>-->
          <p class="product-description"><%= @product_variant.details %></p>
          <br><br>
          <i><h5 class="price">current price:
            <span class="bdt">
              <%= @product_variant.final_price ? @product_variant.final_price : @product_variant.price %>
            </span></h5></i>
          <br>

          <div class="product-quantity">
            <% if @product_variant.in_stock? %>
              <h5> Available: <%= pluralize(@product_variant.in_stock, 'item') %> </h5>
              <% if @item_in_cart %>
                <%= form_for(@item_in_cart, url: ordered_item_path(@item_in_cart), local: true, method: :patch) do |f| %>
                  <%= f.hidden_field :product_variant_id, value: @product_variant.id %>
                  <%= f.hidden_field :price, value: @product_variant.price %>
                  <%= f.hidden_field :purchase_price, value: @product_variant.purchase_price %>
                  <h5>
                    Quantity:
                    <%= f.number_field :quantity, value: @item_in_cart.quantity, min: 1, max: @product_variant.in_stock, style: 'width: 30%;', class: 'avoid_line_break form-control' %>
                  </h5>
                  <h5 style="color: #039524"><b><i>Product already in the Cart!</i></b></h5>
                  <%= f.submit "Update Quantity", class: "btn btn-info" %>
                  <%= link_to 'Cancel', :back, class: 'btn btn-danger' %>
                <% end %>
              <% else %>
                <%= form_for(@ordered_item, url: ordered_items_path(@product_variant), local: true, method: :post) do |f| %>
                  <%= f.hidden_field :product_variant_id, value: @product_variant.id %>
                  <%= f.hidden_field :price, value: @product_variant.price %>
                  <%= f.hidden_field :purchase_price, value: @product_variant.purchase_price %>
                  <h5>
                    Quantity:
                    <%= f.number_field :quantity, value: 1, min: 1, max: @product_variant.in_stock, style: 'width: 30%;', class: 'avoid_line_break form-control' %>
                  </h5>

                  <%= f.submit "Add To Cart", class: "btn btn-success" %>
                  <%= link_to 'Cancel', :back, class: 'btn btn-danger' %>
                <% end %>
              <% end %>
            <% else %>
              <div class="out-of-stock">
                <h4>Out Of Stock</h4>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <br>

  <% if @product_variant.product.product_variants.count > 1 %>

    <div>
      <div class="col-md-12">
        <table class="table table-bordered table-striped table-hover " style="background-color: #c9c8c8;">
          <tr>
            <th colspan="4" style="text-align: center ">Available Variants</th>
          </tr>
          <tr>
            <th style="text-align: center ">Image</th>
            <th style="text-align: center ">Price</th>
            <th style="text-align: center ">Details</th>
          </tr>
          <% @product_variant.product.product_variants.each do |variant| %>
            <% if variant.id != @product_variant.id %>
              <tr>
                <td style="width: 150px; align-items: center">
                  <%= link_to product_product_variant_path(variant.product_id, variant) do %>
                    <div style="width: 100px; height: 100px;">
                      <%= image_tag ("mobile_demo.jpg"), class: "pic-1" %>
                    </div>
                  <% end %>
                </td>
                <td style="width: 200px;"><%= number_to_currency variant.price %></td>
                <td><%= variant.details %></td>
              </tr>
            <% end %>
          <% end %>
        </table>
      </div>
    </div>
  <% end %>



  <div class="row"><br></div>
  <h3 align="center">You might also be interested in:</h3>
  <hr>
  <div class="row">
    <% @product_variant.product.category.products.each do |product| %>
      <%# if @products.first.id != product.id %>
      <div class="col-md-2 col-sm-4">
        <div class="product-grid2">
          <%= link_to product_product_variant_path(product, product.product_variants.first) do %>
            <div class="product-image2">
              <%= image_tag ("mobile_demo.jpg"), class: "pic-1" %>
            </div>
            <div class="product-content">
              <p class="title"><%= product.title.truncate(50, separator: /\s/) %></p>
              <span class="price"><%= number_to_currency product.product_variants.first.price %></span>
            </div>
          <% end %>
        </div>
      </div>
      <%# end %>
    <% end %>
  </div>
</div>







