<div class="container" align="center"><br>

  <% if @category and params[:q] == @category.title %>
    <h3>Search Result for <%= @category.title %> Category </h3>
    <hr>
  <% elsif @sub_category and params[:q] == @sub_category.title %>
    <h3>Search Result for <%= @sub_category.title %> Subcategory </h3>
    <hr>
  <% end %>
  <div class="row">
    <% @products.each do |product| %>
      <div class="col-md-2 col-sm-4">
        <div class="product-grid2">
          <%= link_to product_product_variant_path(product, product.product_variants.first) do %>
            <div class="product-image2">
              <%= image_tag(product.brand_image.attached? ? product.brand_image : 'image-not-found.png') %>
            </div>
            <div class="product-content">
              <p class="title"><%= product.title.truncate(25, separator: /\s/) %></p>
              <% if product.has_valid_discount %>
                <s><span class="bdt">
                  <%= formatted_price(product.product_variants.first.price) %>
                </span></s>
                <div class="price">
                  <span class="bdt">
                    <%= formatted_price(product.discount_price(product.product_variants.first)) %>
                  </span>
                </div>
              <% elsif product.category.has_valid_discount %>
                <s><span class="bdt">
                  <%= formatted_price(product.product_variants.first.price) %>
                </span></s>
                <div class="price">
                  <span class="bdt">
                    <%= formatted_price(product.category.discount_price(product.product_variants.first)) %>
                  </span>
                </div>
              <% else %>
                <span class="price bdt">
                  <%= formatted_price(product.product_variants.first.price) %>
                </span>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
    <hr>
  </div>
</div>
